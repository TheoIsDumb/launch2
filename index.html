<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="output.css">
    <link rel="stylesheet" href="style.css">
    <title>launcher2</title>
</head>

<body class="text-white">
    <div class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 flex flex-col">
        <span class="date font-[nokia-italic]">hello</span>

        <span class="india font-['nokia-outline-italic'] text-7xl">
            00:00:00
        </span>

        <span class="year font-[nokia-italic] ml-auto mt-[-10px]">hello</span>
    </div>

    <div class="appsContainer bg-black/20 rounded-lg shadow-md
    fixed bottom-12 left-1/2 -translate-x-1/2 h-96 w-[calc(100dvw-4rem)] overflow-auto
    p-4 flex flex-col items-start font-['nokia-italic']"></div>

    <template id="itemTemplate">
        <div class="app-list-item flex gap-2 items-center">
            <img src="" alt="" class="size-10">
            <span class="label"></span>
        </div>
    </template>
</body>

<script>
    const indianTimeDiv = document.querySelector('span.india');
    const yearDiv = document.querySelector('span.year');
    const dateDiv = document.querySelector('span.date');
    const appsContainer = document.querySelector('.appsContainer');
    const template = document.getElementById('itemTemplate');

    function updateTime() {
        const time = new Date().toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        indianTimeDiv.innerHTML = time;
    }

    function updateDate() {
        const date = new Date();

        yearDiv.innerText = date.getFullYear();
        dateDiv.innerText = date.toLocaleString('default', { month: 'long' }).toLowerCase() + " " + date.getDate();
    }

    setInterval(() => {
        updateTime();
    }, 1000);

    setInterval(updateDate, 10000);

    updateTime();
    updateDate();

    ////////////////////////////////////////////////////////////////////////

    async function loadApps() {
        const resp = await fetch(Bridge.getAppsURL());
        const json = await resp.json();

        const apps = json.apps.sort((a, b) => {
            if (a.label < b.label) {
                return -1;
            }
            if (a.label > b.label) {
                return 1;
            }
            return 0;
        });

        for (const app of json.apps) {
            const item = template.content.firstElementChild.cloneNode(true);
            item.querySelector('.label').innerText = app.label.toUpperCase();
            item.querySelector('img').src = Bridge.getDefaultAppIconURL(app.packageName)
            item.addEventListener('click', () => {
                Bridge.requestLaunchApp(app.packageName);
            })
            appsContainer.appendChild(item);
        }
    }

    loadApps()
</script>

</script>

</html>